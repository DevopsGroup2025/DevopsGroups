- name: Deploy Backend API (NestJS)
  hosts: role_backend
  become: no
  gather_facts: yes

  vars:
    project_name: "{{ project_name | default('webapp') }}"
    app_dir: "/home/{{ ansible_user }}/backend"
    backend_port: 3001
    # Database configuration (pass via -e or group_vars)
    database_host: "{{ db_endpoint | default('localhost') }}"
    database_port: 5432
    database_username: "{{ db_username | default('dbadmin') }}"
    database_password: "{{ db_password }}"
    database_name: "{{ db_name | default('notesdb') }}"

  roles:
    - role: backend
