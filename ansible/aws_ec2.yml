# inventory/aws_ec2.yml
plugin: aws_ec2

# AWS region(s)
regions:
- eu-west-1

# Filter running instances by tags
filters:
  instance-state-name: running
  "tag:Project": terraform-ansible-webapp
  "tag:Environment": ["dev"]

# Grouping hosts dynamically
keyed_groups:
# Group by role
- key: tags.Role
  prefix: role
  separator: "_"

# Group by environment
- key: tags.Environment
  prefix: env
  separator: "_"

# Group by instance type
- key: instance_type
  prefix: type
  separator: "_"

# Compose instance attributes for convenience
compose:
  instance_name: tags.Name
  instance_role: tags.Role
  environment: tags.Environment
  project: tags.Project
  managed_by: tags.ManagedBy
  private_ip: private_ip_address
  public_ip: public_ip_address

# How hosts are identified
hostnames:
- tag:Name
- private-ip-address
- public-ip-address

# Optional: strict mode ensures missing vars/errors are caught early
strict: False
