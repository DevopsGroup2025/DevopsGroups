- name: Deploy Frontend Application (Next.js)
  hosts: role_frontend
  become: no
  gather_facts: yes

  vars:
    project_name: "{{ project_name | default('webapp') }}"
    app_dir: "/home/{{ ansible_user }}/frontend"
    frontend_port: 3000
    # Automatically gather all backend private IPs
    backend_hosts: "{{ groups['role_backend'] | map('extract', hostvars, 'private_ip') | list }}"
    backend_api_url: "http://{{ backend_hosts[0] }}:3001"  # Default to first backend for API requests

  roles:
    - role: frontend
